#set( $catalogid  = $mediaarchive.getCatalogId() )
#set( $title = $context.getRequestParameter("title") )
#set( $sourcepath = $context.getRequestParameter("sourcepath") )
#set( $assetid = $context.getRequestParameter("assetid") )
#set( $imgloc = "$home/$catalogid/downloads/preview/medium/$sourcepath/medium.jpg")
#set( $link = $context.getRequestParameter("href") )
#set( $children = $mediaarchive.getPageManager().getChildrenPathsSorted("/WEB-INF/data/$catalogid/generated/$sourcepath/mediums/"))
<div class='emthumbzoom' id="draggable|$assetid|$catalogid">
	<div class='emthumbzoomimage'>
	<a href="$link">
		#if( $children.size() > 0 )
			#set($first = $children.get(0) )
			#set($filename = $first.substring($first.lastIndexOf("/"),$first.length() ) )
  		    #set($imgloc = "${home}$cataloghome/downloads/data/generated/$sourcepath/mediums$filename")
		#end
		<img id="emthumbviewer" src="$imgloc" />
	</a>
	</div>	
	<table class="emtable" width="100%">
	<tr class="row" >
		<td valign="top" width="100%"><a href="$link">$title</td>

	</tr>
	</table>
</div>

#if( $children.size() > 1 )

<input type="hidden" name="none" id="listofimages"  />
<input type="hidden" name="none" id="imagecounter" value="1" />
<script>

var listval = "#foreach( $childpath in $children )#if( $velocityCount > 1 )|#end${childpath}#end";
var list = document.getElementById("listofimages");
list.value = listval;

showNextThumb = function()
{
	var el = document.getElementById("emhover");
	el = jQuery(el);
	if( el.css('display') != "none" ) 
	{
		//check visible
		var list = document.getElementById("listofimages");
		var listvals = list.value.split("|");
		
		var countfield = document.getElementById("imagecounter");
		count = parseInt(countfield.value);

		//alert("Showig" + listvals + " " + count);
		
		var path = listvals[count];
			
		var img = document.getElementById("emthumbviewer");

		var filename = path.substring(path.lastIndexOf("/"), path.length );

		img.src = "${home}$cataloghome/downloads/data/generated/$sourcepath/mediums" + filename;
		count  = count + 1;
		if( count == listvals.length)
		{
			count = 0;
		}
		countfield.value = count;
		setTimeout("showNextThumb()",1500); //so we keep checking forever
	}
} 
setTimeout("showNextThumb()",1500);

</script>
	
#end	
