<table cellspacing="0"  cellpadding="0" width="224" >

<tr>
	<td>
	$pages.include("$cataloghome/rollup/header.html?pluginpath=${cataloghome}/side/multicatalogs.html")
	</td>	
</tr>

#if( !$user.getProperty("searchtype") )
	<!-- $user.setProperty("searchtype", "categories") -->
#end

	#if ($canbrowsecategories)
	<tr>
	<td>
	
	<script type="text/javascript" >
	catalogTree = new Object();
	catalogTree.lastselected = "";
	catalogTree.name = "catalogTree";
	catalogTree.jumpToNode = function(inNodeId)
	{	
		this.selectRow( inNodeId );
		if( $content.path.startsWith("$cataloghome/categories") == false )
		{
			var path = "$home$cataloghome/categories/" + inNodeId + ".html";
			document.location = path;
			return false;
		}
		var path = "$home$cataloghome/categories/" + inNodeId + ".html";

		
		var hash = path + "?oemaxlevel=3|maincontent";
		hash = hash.replace(/^.*#/, '');
		// moves to a new page. 
		// page load is called at once.
		jQuery.history.load(hash);

		
		
		jQuery("#emresultcontent").load(path, {origURL: "$content.path",oemaxlevel: 2 });
		var targetDiv = "#" + this.name + "treerow" + inNodeId;
		targetDiv = targetDiv.replace(/\//g, "\\/");
		jQuery(targetDiv).load('$home$cataloghome/side/tree/select.html', {nodeID: inNodeId, categoryid: inNodeId, origURL: "$content.path" });
		return false;
	}
	catalogTree.toggleNode = function(inNodeId,inTreeId, inNodeId)
	{
		this.selectRow( inNodeId );
		var targetDiv = "#" + this.name + "treerow" + inNodeId;
		targetDiv = targetDiv.replace(/\//g, "\\/");
		jQuery(targetDiv).load('$home$cataloghome/side/tree/toggle.html', {nodeID: inNodeId, treeid: inTreeId, origURL: "$content.path" });
		return false;
	}
	catalogTree.jumpAndOpenNode = function(inId,inTreeId, inNodeId)
	{		
		return this.jumpToNode(inId);
	}
	
	catalogTree.selectRow = function( inNodeId )
	{
		jQuery("div.dtree .dTreeNodeSel").removeClass("dTreeNodeSel");
		jQuery("#" + this.name + "treeitem" + inNodeId).addClass("dTreeNodeSel");
		this.lastselected = inNodeId;
	}
	
	jQuery(document).ready(function() 
{ 
	$('.dtree .treerowtext' ).livequery(
	function()
	{
		jQuery(this).hover(
			function () 
			{
		        $(this).addClass("emtreehover");
		 	}, 
			function () {
			    $(this).removeClass("emtreehover");
			}
		);
		jQuery(this).click( function(event)
			{
				if( $(event.target).hasClass("treerowtext") )
				{
					var id = $(this).attr("nodeid");
					catalogTree.jumpToNode(id,id);
				}
			}
		);
	});
});
	
	
	</script>
	<style type="text/css">
	div.dtree div { background-color: transparent; }
	div.dtree div.dTreeNodeSel { background-color: #c0d2ec; }
	</style>
	$pages.include("${cataloghome}/rollup/header.html?pluginpath=$cataloghome/side/browse.html")
	</td>	
	</tr>
#end
</table>