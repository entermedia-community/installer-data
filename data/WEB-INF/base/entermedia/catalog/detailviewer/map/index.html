#set ($catalogid = $context.getRequestParameter("catalogid"))
#set ($view = "asset/geolocation")
#set ($id = $context.getRequestParameter("id"))
<div id="${view}editor">
#if( !$catalogid )
	#set( $catalogid = $mediaarchive.getCatalogId() )
#end

#if(!$searcher)
	#set ( $searchtype = $context.getRequestParameter("searchtype") )
	#if( $searchtype )
		#set ( $searcher = $searcherManager.getSearcher($catalogid, $searchtype ) )
	#else		
		#set ( $searcher = $mediaarchive.assetSearcher )
	#end
#end
#set( $catalogid = $searcher.getCatalogId() )
#set( $searchtype= $searcher.getSearchType() )
#if(!$data)
	#if( $asset )
		#set( $data = $asset )

	#else
		#set ($data = $searcher.searchById($id))		
	#end
	$context.putPageValue("data", $data)	
#end

$context.putPageValue("searcher", $searcher)

#set ( $openview = $context.getRequestParameter("openview") )
#set ( $edit = $context.getRequestParameter("edit") )
#if($errors)
<span style="color:red;">Your entry is invalid.  Please check your values and try again.</span>
#set($edit = "true")
#end
	<form name="formedit$view" id="formedit$view" class="ajaxform" targetdiv="${view}editor" method="post" action="$home$cataloghome/detailviewer/map/save.html?oemaxlevel=1" >

[[Search for a location, drag the icon to the correct place and click the save button]].	
		<input type="hidden" name="saveasnew" value="false" />
		<input type="hidden" name="save" value="true" />
		<input type="hidden" name="catalogid" value="$!catalogid" />
		<input type="hidden" name="searchtype" value="$searcher.getSearchType()" />
		
		<input type="hidden" name="view" value="$view" />
		
		<input type="hidden" name="assetid" value="$asset.getId()" />
		#if( $searchtype != "asset" )
			<input type="hidden" name="field" value="assetid" />
			<input type="hidden" name="assetid.value" value="$asset.getId()" />
		#end
		<input type="hidden" name="id" value="$!data.id" />
		$context.putPageValue("view",$view)	
		$context.putPageValue("origURL", "$cataloghome/assets/${asset.sourcePath}.html")
		$pages.include("/$applicationid/components/xml/detaileditor.html", $context)
		<br/>
		<p align="right" style="padding-right: 200px;">
			<input  type="button" 
				onclick="jQuery(this.form).submit();"
			value="[[Save values]]"/>
		</p>
	</form>

