#set($details = $searcher.getSearchProperties($user))
#set($idtoedit = $context.getRequestParameter("idtoedit"))

<div id="listedit" class="em-rounded" style="margin-bottom: 10px;">
	<div id="emselectable">
		<form name="editrow" id="editrow" action="$home$page.path">
		
    		<table class="standard-table" style="width:100%;">
    			<tr>
    				<th></th>
					#foreach( $detail in $details )
						<th align="left" nowrap >$detail.getText($context)</th>
					#end
    			</tr>		
    			
    			#foreach ( $hit in $datalist.getPageOfHits() )
        			<tr rowid="$hit.id">
        				<td noclick="true">
							<a href="deletelist.html?catalogid=$searcher.catalogId&searchtype=$searcher.searchType&id=$hit.id">
								<img src="$home$themeprefix/images/remove.png" title="Remove">
							</a>
						</td>
						#foreach( $detail in $details )
							#set( $newval = "$!hit.get($detail.getId())")
							#if($newval && $newval != "" && $detail.isList())
								#set( $newval = $searcherManager.getListData($detail,$newval) )
							#end
							#if($hit.id == $idtoedit)
								<td nowrap noclick="true">
									<input name="field" type="hidden" value="$detail" />
									<input name="${detail}.value" id="${detail}.id" type="text" value="$newval" />
								</td>
							#else		
								<td nowrap>$newval</td>
							#end
						#end
        			</tr>
    			#end
    		</table>
		
			<input type="hidden" name="idtoedit" id="emselectedrow" />
			<input type="hidden" name="searchtype" value="$searcher.getSearchType()" />
			#if($idtoedit)
				<input name="id" type="hidden" value="$idtoedit" />
				<input type="hidden" name="save" value="true"/>
			#end
		</form>
	</div>
	
	<div style="text-align: left; padding-left: 20px; padding-top: 5px;">
		
			#if ( $datalist.totalPages == 0 )
			#elseif( $datalist.totalPages == 1 )
			#elseif( $datalist )
				#set($thispage = $datalist.getPage())
				[[Page]] <b>$thispage</b> [[of]] $datalist.totalPages  
				&nbsp;&nbsp;
				
				#if( $datalist.prevPage() )
				
				<a href="" onclick="jQuery('#listedit').load('$home$page.path?page=$datalist.prevPage()&hitssessionid=$datalist.sessionId&catalogid=$searcher.catalogId&searchtype=$searcher.searchType'); return false;">
					<b>&lt;&lt;  [[Back]]</b>
				</a>
				#end
				
				#if ( $datalist.nextPage() )
				<a href="" onclick="jQuery('#listedit').load('$home$page.path?page=$datalist.nextPage()&hitssessionid=$datalist.sessionId&catalogid=$searcher.catalogId&searchtype=$searcher.searchType'); return false;">
					<b> [[Forward]] &gt;&gt;</b>
				</a>
				#end
			#end
	</div>
	<h3>[[Found]] $datalist.size() [[Records]]</h3>
			
	#set( $thispage = $datalist.getPage()+-1)
	#set( $start = $datalist.getHitsPerPage() * $thispage )
	#set( $end = $start + $datalist.getPageOfHits().size() )
	#set( $start = $start + 1)
		
	<div class="embutton">
		<a href="addlist.html?catalogid=$searcher.catalogId&searchtype=$searcher.searchType&field=id">[[Add New Record]]</a>
	</div>
	<div class="embutton">
		<a href="" onclick="jQuery('#emselectable form').submit(); self.parent.jQuery.fn.fancybox.close();">[[Save]]</a>
	</div>
</div>
	