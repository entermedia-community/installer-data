#set($searcher = $mediaarchive.getAssetSearcher())
#set($detailid = $context.getRequestParameter("id"))
#if(!$detailid)
	#set($detailid = "id")
#end

<div id="modifyproperties" class="em-rounded" style="margin-bottom: 10px;">
	<h1>Property Editor</h1>
	<div>
		<select name="proptomodify" onchange="loadPropertyEdit();">
			#foreach( $detail in $searcher.getPropertyDetails())
				<option value="$detail.id" #if($detailid == $detail.id)selected="selected"#end>$detail.text</option>
			#end
		</select>
		<input type="button" value="Create" onclick="createProperty();"/>
		<input type="button" value="Delete" onclick="removeProperty();"/>
	</div>
	<div id="propertyedit">
		$context.setRequestParameter("catalogid", $mediaarchive.getCatalogId())
		$context.setRequestParameter("searchtype", $searcher.getSearchType())
		$context.setRequestParameter("id", $detailid)
		$pages.include("$cataloghome/settings/metadata/properties/modifyproperty.html", $context)
	</div>
</div>

<script type="text/javascript">
	loadPropertyEdit = function() {
		var selected = jQuery("select option:selected");
		var selectedid = selected.val();
		jQuery("#propertyedit").load("$home$cataloghome/settings/metadata/properties/modifyproperty.html?id=" + selectedid + "&catalogid=${mediaarchive.getCatalogId()}&searchtype=${searcher.getSearchType()}");
	}
	
	removeProperty = function() {
		var selected = jQuery("select option:selected");
		var selectedid = selected.val();
		jQuery("#modifyproperties").load("removeproperty.html?id=" + selectedid + "&catalogid=${mediaarchive.getCatalogId()}&searchtype=${searcher.getSearchType()}");
	}
	
	createProperty = function() {
		jQuery("#modifyproperties").load("addproperty.html?catalogid=${mediaarchive.getCatalogId()}&searchtype=${searcher.getSearchType()}");
	}
</script>